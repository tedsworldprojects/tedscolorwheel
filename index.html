<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-g" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Teds Super-Fast Wheel</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3-color.v3.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-gray-900 text-white">
    <div id="root"></div>
    <script type="text/babel">
      // --- All source code is now in this script tag ---

      // From: constants.ts
      const ColorHarmony = {
        COMPLEMENTARY: 'Complementary',
        ANALOGOUS: 'Analogous',
        TRIADIC: 'Triadic',
        TETRADIC: 'Tetradic',
        SPLIT_COMPLEMENTARY: 'Split Complementary',
        MONOCHROMATIC: 'Monochromatic',
      };
      
      // From: services/colorService.ts
      const wrapHue = (hue) => (hue + 360) % 360;

      const calculateHarmony = (baseColor, harmony) => {
        const d3Color = d3.hsl(baseColor.h, baseColor.s, baseColor.l);

        switch (harmony) {
          case ColorHarmony.COMPLEMENTARY:
            return [
              d3Color,
              d3Color.copy({ h: wrapHue(d3Color.h + 180) }),
            ];
          case ColorHarmony.ANALOGOUS:
            return [
              d3Color.copy({ h: wrapHue(d3Color.h - 30) }),
              d3Color,
              d3Color.copy({ h: wrapHue(d3Color.h + 30) }),
            ];
          case ColorHarmony.TRIADIC:
            return [
              d3Color,
              d3Color.copy({ h: wrapHue(d3Color.h + 120) }),
              d3Color.copy({ h: wrapHue(d3Color.h + 240) }),
            ];
          case ColorHarmony.TETRADIC:
            return [
              d3Color,
              d3Color.copy({ h: wrapHue(d3Color.h + 90) }),
              d3Color.copy({ h: wrapHue(d3Color.h + 180) }),
              d3Color.copy({ h: wrapHue(d3Color.h + 270) }),
            ];
          case ColorHarmony.SPLIT_COMPLEMENTARY:
            return [
              d3Color,
              d3Color.copy({ h: wrapHue(d3Color.h + 150) }),
              d3Color.copy({ h: wrapHue(d3Color.h + 210) }),
            ];
          case ColorHarmony.MONOCHROMATIC:
            return [
              d3Color.copy({ l: Math.max(0, d3Color.l - 0.2) }),
              d3Color.copy({ l: Math.max(0, d3Color.l - 0.1) }),
              d3Color,
              d3Color.copy({ l: Math.min(1, d3Color.l + 0.1) }),
              d3Color.copy({ l: Math.min(1, d3Color.l + 0.2) }),
            ];
          default:
            return [d3Color];
        }
      };

      // From: components/PaletteDisplay.tsx
      const PaletteDisplay = ({ colors }) => {
        const [copiedHex, setCopiedHex] = React.useState(null);
        
        const handleCopy = (hex) => {
          navigator.clipboard.writeText(hex);
          setCopiedHex(hex);
          setTimeout(() => setCopiedHex(null), 1500);
        };

        return (
          <div className="flex flex-col w-full h-full">
            {colors.map((color, index) => {
              const hex = color.formatHex();
              
              const rgb = color.rgb();
              const luminance = (0.299 * rgb.r + 0.587 * rgb.g + 0.114 * rgb.b);
              const isLight = luminance > 128;
              
              const textColor = isLight ? 'text-black' : 'text-white';

              const isFirst = index === 0;
              const isLast = index === colors.length - 1;
              const roundClasses = isFirst && isLast 
                ? 'rounded-lg' 
                : isFirst 
                ? 'rounded-t-lg' 
                : isLast 
                ? 'rounded-b-lg' 
                : '';

              return (
                <div
                  key={`${hex}-${index}`}
                  className={`flex-grow flex items-center justify-center p-4 cursor-pointer group relative ${roundClasses}`}
                  style={{ backgroundColor: hex }}
                  onClick={() => handleCopy(hex)}
                >
                  <div className="flex flex-col items-center">
                    <span className={`font-mono font-semibold ${textColor} transition-opacity duration-300`}>
                      {hex.toUpperCase()}
                    </span>
                    <span className={`text-xs mt-1 ${textColor} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}>
                      {copiedHex === hex ? 'Copied!' : 'Click to copy'}
                    </span>
                  </div>
                </div>
              );
            })}
          </div>
        );
      };

      // From: components/HarmonySelector.tsx
      const HarmonySelector = ({ selectedHarmony, onHarmonyChange }) => {
        const harmonies = Object.values(ColorHarmony);

        return (
          <div className="w-full p-4 h-full">
            <h3 className="text-lg font-bold mb-4 text-gray-300">Color Combination</h3>
            <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-1 gap-2">
              {harmonies.map((harmony) => (
                <button
                  key={harmony}
                  onClick={() => onHarmonyChange(harmony)}
                  className={`w-full text-left p-2 rounded transition-colors duration-200 text-sm ${
                    selectedHarmony === harmony
                      ? 'bg-blue-600 text-white font-semibold'
                      : 'bg-gray-700 hover:bg-gray-600'
                  }`}
                >
                  {harmony}
                </button>
              ))}
            </div>
          </div>
        );
      };

      // From: components/ColorInfo.tsx
      const ColorInfo = ({ color }) => {
        const [copiedValue, setCopiedValue] = React.useState(null);

        const copyToClipboard = (text) => {
          navigator.clipboard.writeText(text).then(() => {
            setCopiedValue(text);
            setTimeout(() => setCopiedValue(null), 2000);
          });
        };

        const hex = color.formatHex();
        const rgb = color.rgb();
        const hsl = d3.hsl(color);

        const rgbString = `${Math.round(rgb.r)}, ${Math.round(rgb.g)}, ${Math.round(rgb.b)}`;
        const hslString = `${Math.round(hsl.h)}, ${Math.round(hsl.s * 100)}%, ${Math.round(hsl.l * 100)}%`;

        const infoItems = [
          { label: 'HEX', value: hex },
          { label: 'RGB', value: rgbString },
          { label: 'HSL', value: hslString },
        ];

        return (
          <div className="bg-gray-700/50 p-4 rounded-md mt-6 w-full">
            <h3 className="text-base font-semibold mb-4 text-center text-gray-300 tracking-wide">Base Color</h3>
            <div className="grid grid-cols-3 gap-2 text-center">
              {infoItems.map(item => (
                <div key={item.label}>
                  <span className="text-xs text-gray-400 uppercase">{item.label}</span>
                  <button
                    onClick={() => copyToClipboard(item.value)}
                    className="w-full font-mono text-xs mt-1 py-2 px-1 sm:px-2 bg-gray-700 rounded hover:bg-gray-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 whitespace-nowrap overflow-hidden text-ellipsis"
                    title={`Copy ${item.value}`}
                  >
                    {copiedValue === item.value ? 'Copied!' : item.value}
                  </button>
                </div>
              ))}
            </div>
          </div>
        );
      };
      
      // From: components/ColorWheel.tsx
      const ColorWheel = ({ color, onColorChange, size = 300 }) => {
        const wheelRef = React.useRef(null);
        const containerRef = React.useRef(null);
        const [isDragging, setIsDragging] = React.useState(false);
        const [actualSize, setActualSize] = React.useState(size);

        React.useEffect(() => {
          const measureContainer = () => {
            if (containerRef.current) {
              const parentWidth = containerRef.current.getBoundingClientRect().width;
              setActualSize(Math.min(parentWidth, size));
            }
          };
          measureContainer();
          window.addEventListener('resize', measureContainer);
          return () => window.removeEventListener('resize', measureContainer);
        }, [size]);

        const handleInteraction = React.useCallback((e) => {
          if (!wheelRef.current) return;

          const rect = wheelRef.current.getBoundingClientRect();
          const centerX = actualSize / 2;
          const centerY = actualSize / 2;

          const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;
          const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;

          const x = clientX - rect.left - centerX;
          const y = clientY - rect.top - centerY;
          
          const angle = (Math.atan2(y, x) * 180 / Math.PI + 360) % 360;
          const distance = Math.min(Math.sqrt(x * x + y * y), centerX);
          
          const saturation = distance / centerX;

          onColorChange({ ...color, h: angle, s: saturation });
        }, [color, onColorChange, actualSize]);

        const stopDragging = React.useCallback(() => {
          setIsDragging(false);
        }, []);

        const startDragging = React.useCallback((e) => {
          setIsDragging(true);
          handleInteraction(e);
        }, [handleInteraction]);

        const onDrag = React.useCallback((e) => {
          if (isDragging) {
            e.preventDefault();
            handleInteraction(e);
          }
        }, [isDragging, handleInteraction]);

        React.useEffect(() => {
          window.addEventListener('mousemove', onDrag);
          window.addEventListener('touchmove', onDrag, { passive: false });
          window.addEventListener('mouseup', stopDragging);
          window.addEventListener('touchend', stopDragging);

          return () => {
            window.removeEventListener('mousemove', onDrag);
            window.removeEventListener('touchmove', onDrag);
            window.removeEventListener('mouseup', stopDragging);
            window.removeEventListener('touchend', stopDragging);
          };
        }, [isDragging, onDrag, stopDragging]);

        const handleLightnessChange = (e) => {
          onColorChange({ ...color, l: parseFloat(e.target.value) });
        };

        const selectorX = (actualSize / 2) + (color.s * actualSize / 2) * Math.cos(color.h * Math.PI / 180);
        const selectorY = (actualSize / 2) + (color.s * actualSize / 2) * Math.sin(color.h * Math.PI / 180);
        
        const baseColorForGradient = d3.hsl(color.h, color.s, 0.5).toString();

        return (
          <div ref={containerRef} className="w-full flex flex-col items-center space-y-4">
            <div
              ref={wheelRef}
              className="relative rounded-full cursor-pointer"
              style={{
                width: `${actualSize}px`,
                height: `${actualSize}px`,
                background: `
                  radial-gradient(circle, white, transparent),
                  conic-gradient(from 90deg, 
                    hsl(0, 100%, 50%), hsl(30, 100%, 50%), hsl(60, 100%, 50%), 
                    hsl(90, 100%, 50%), hsl(120, 100%, 50%), hsl(150, 100%, 50%),
                    hsl(180, 100%, 50%), hsl(210, 100%, 50%), hsl(240, 100%, 50%),
                    hsl(270, 100%, 50%), hsl(300, 100%, 50%), hsl(330, 100%, 50%),
                    hsl(360, 100%, 50%)
                  )
                `,
                touchAction: 'none'
              }}
              onMouseDown={startDragging}
              onTouchStart={startDragging}
            >
              <div 
                className="absolute w-5 h-5 rounded-full border-2 border-white shadow-lg"
                style={{
                  left: `${selectorX - 10}px`,
                  top: `${selectorY - 10}px`,
                  backgroundColor: d3.hsl(color.h, color.s, color.l).toString(),
                  pointerEvents: 'none'
                }}
              />
            </div>
            <input
              type="range"
              min="0"
              max="1"
              step="0.01"
              value={color.l}
              onChange={handleLightnessChange}
              className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"
              style={{ background: `linear-gradient(to right, #000, ${baseColorForGradient}, #fff)` }}
            />
          </div>
        );
      };

      // From: App.tsx
      const App = () => {
        const [baseColor, setBaseColor] = React.useState({ h: 195, s: 0.85, l: 0.5 });
        const [harmony, setHarmony] = React.useState(ColorHarmony.COMPLEMENTARY);

        const paletteContainerRef = React.useRef(null);
        const isInitialMount = React.useRef(true);

        const d3BaseColor = React.useMemo(() => {
          return d3.hsl(baseColor.h, baseColor.s, baseColor.l);
        }, [baseColor]);
        
        const currentPalette = React.useMemo(() => {
          return calculateHarmony(baseColor, harmony);
        }, [baseColor, harmony]);

        React.useEffect(() => {
          if (isInitialMount.current) {
            isInitialMount.current = false;
          } else {
            paletteContainerRef.current?.scrollIntoView({ behavior: 'smooth', block: 'end' });
          }
        }, [harmony]);

        return (
          <div className="min-h-screen bg-gray-900 text-white font-sans p-4 sm:p-6 lg:p-8">
            <header className="text-center mb-8">
              <h1 className="text-3xl sm:text-4xl font-bold tracking-tight">Teds Super-Fast Wheel</h1>
              <p className="text-gray-400 mt-2">An interactive tool to create beautiful color palettes.</p>
            </header>

            <main className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 md:gap-8 max-w-7xl mx-auto">
              
              <div className="lg:col-span-2 bg-gray-700/30 p-1 rounded-xl shadow-lg">
                <div className="bg-gray-800 rounded-lg p-6 h-full flex flex-col items-center justify-center">
                  <ColorWheel 
                    color={baseColor} 
                    onColorChange={setBaseColor}
                    size={280}
                  />
                  <ColorInfo color={d3BaseColor} />
                </div>
              </div>

              <div className="lg:col-span-3 flex flex-col md:flex-row gap-4 md:gap-8">
                
                <div className="md:w-1/3 lg:w-2/5 bg-gray-700/30 p-1 rounded-xl shadow-lg">
                  <div className="bg-gray-800 rounded-lg h-full">
                    <HarmonySelector selectedHarmony={harmony} onHarmonyChange={setHarmony} />
                  </div>
                </div>
                
                <div ref={paletteContainerRef} className="md:w-2/3 lg:w-3/5 flex bg-gray-700/30 p-1 rounded-xl shadow-lg">
                  <div 
                    className="bg-gray-800 rounded-lg w-full flex overflow-hidden"
                    style={{ transform: 'translateZ(0)' }}
                  >
                    <PaletteDisplay colors={currentPalette} />
                  </div>
                </div>
              </div>

            </main>
            
            <footer className="text-center py-8 text-gray-500 text-sm">
              &copy; TEDS WORLD PROJECTS Super-Fast Color Wheel v1.0
            </footer>
          </div>
        );
      };

      // From: index.tsx
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }

      const root = ReactDOM.createRoot(rootElement);
      root.render(
        <React.StrictMode>
          <App />
        </React.StrictMode>
      );
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>